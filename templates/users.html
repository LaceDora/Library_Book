{% extends "base.html" %}
{#
  templates/users.html

  Danh sách người dùng (view dành cho admin hoặc trang người dùng tuỳ context).
  - Các hành động: xóa user (kèm lịch sử) và xem lịch sử mượn.
#}
{% block content %}
<h3>Danh sách người dùng</h3>
<table class="table table-hover bg-white shadow-sm">
  <thead class="table-dark">
    <tr><th>ID</th><th>Username</th><th>Chức vụ</th><th>Hành động</th></tr>
  </thead>
  <tbody>
    {% for u in users %}
      <tr>
        <td>{{ u.id }}</td>
        <td>{{ u.username }}</td>
        <td>
          {% if u.is_admin %}
            <span class="badge bg-primary">Quản thư</span>
          {% else %}
            {% if u.role == 'student' %}
              <span class="badge bg-success">Sinh viên</span>
            {% elif u.role == 'lecturer' %}
              <span class="badge bg-info">Giảng viên</span>  
            {% elif u.role == 'staff' %}
              <span class="badge bg-secondary">Cán bộ</span>
            {% endif %}
          {% endif %}
        </td>
        <td>
          {% if not u.is_admin %}
            <a class="btn btn-sm btn-danger" href="{{ url_for('user_bp.delete', user_id=u.id) }}" onclick="return confirm('Xác nhận xóa user và toàn bộ lịch sử mượn của họ?')">Xóa</a>
            <a class="btn btn-sm btn-secondary ms-2" href="{{ url_for('user_bp.history', user_id=u.id) }}">Lịch sử</a>
          {% else %}
            <span class="text-muted">-</span>
          {% endif %}
        </td>
      </tr>
    {% else %}
      <tr><td colspan="4" class="text-center text-muted">Không có user nào.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
